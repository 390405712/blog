(window.webpackJsonp=window.webpackJsonp||[]).push([[65],{323:function(t,s,a){"use strict";a.r(s);var n=a(38),e=Object(n.a)({},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"性能优化"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#性能优化","aria-hidden":"true"}},[t._v("#")]),t._v(" 性能优化")]),t._v(" "),a("h2",{attrs:{id:"资源合并压缩"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#资源合并压缩","aria-hidden":"true"}},[t._v("#")]),t._v(" 资源合并压缩")]),t._v(" "),a("ul",[a("li",[t._v("fis")]),t._v(" "),a("li",[t._v("webpack")]),t._v(" "),a("li",[t._v("gulp")])]),t._v(" "),a("h2",{attrs:{id:"图片优化"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#图片优化","aria-hidden":"true"}},[t._v("#")]),t._v(" 图片优化")]),t._v(" "),a("ul",[a("li",[t._v("jpg：有损压缩，压缩率高，不支持透明")]),t._v(" "),a("li",[t._v("png8：256色 + 支持透明（利于性能优化）")]),t._v(" "),a("li",[t._v("png24：2^24色 + 不支持透明")]),t._v(" "),a("li",[t._v("png32：2^32色 + 支持透明")]),t._v(" "),a("li",[t._v("svg：矢量图，代码内嵌相对较小（能用就用）")]),t._v(" "),a("li",[t._v("base64：img标签直接接收inline")]),t._v(" "),a("li",[t._v("webp：安卓环境下比较优秀")])]),t._v(" "),a("h2",{attrs:{id:"css与js的装载和执行"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#css与js的装载和执行","aria-hidden":"true"}},[t._v("#")]),t._v(" css与js的装载和执行")]),t._v(" "),a("img",{attrs:{src:t.$withBase("/assets/performance-RenderTree.png")}}),t._v(" "),a("ol",[a("li",[t._v("根据"),a("code",[t._v("HTML")]),t._v("结构生成"),a("code",[t._v("DOM Tree")])]),t._v(" "),a("li",[t._v("根据"),a("code",[t._v("CSS")]),t._v("生成"),a("code",[t._v("CSSOM")])]),t._v(" "),a("li",[t._v("将"),a("code",[t._v("DOM")]),t._v("和"),a("code",[t._v("CSSOM")]),t._v("整合形成"),a("code",[t._v("RenderTree")])]),t._v(" "),a("li",[t._v("根据"),a("code",[t._v("RenderTree")]),t._v("开始渲染和展示")]),t._v(" "),a("li",[t._v("遇到"),a("code",[t._v("<script>")]),t._v("会执行并阻塞渲染")])]),t._v(" "),a("h2",{attrs:{id:"懒加载和预加载"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#懒加载和预加载","aria-hidden":"true"}},[t._v("#")]),t._v(" 懒加载和预加载")]),t._v(" "),a("ul",[a("li",[t._v("路由懒加载")]),t._v(" "),a("li",[t._v("图片懒加载")])]),t._v(" "),a("h2",{attrs:{id:"重绘与回流"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#重绘与回流","aria-hidden":"true"}},[t._v("#")]),t._v(" 重绘与回流")]),t._v(" "),a("ul",[a("li",[t._v("重绘：当"),a("code",[t._v("RenderTree")]),t._v("中一些元素需要更新属性，而这些属性只是影响元素的外观、风格，而不会影响布局的，比如background-color")]),t._v(" "),a("li",[t._v("回流（reflow）：当"),a("code",[t._v("RenderTree")]),t._v("中一部分因为元素的规模尺寸布局隐藏被改变而需要重新构建")]),t._v(" "),a("li",[t._v("回流必将触发重绘，重绘不一定触发回流")])]),t._v(" "),a("h3",{attrs:{id:"避免回流"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#避免回流","aria-hidden":"true"}},[t._v("#")]),t._v(" 避免回流")]),t._v(" "),a("ul",[a("li",[t._v("用translate替代top")]),t._v(" "),a("li",[t._v("用opacity替代visibility")]),t._v(" "),a("li",[t._v("先定义好class,最后一次性的修改DOM的className")]),t._v(" "),a("li",[t._v("先将DOM display:none,然后修改属性，最后display:block")]),t._v(" "),a("li",[t._v("不将DOM结点属性遍历")]),t._v(" "),a("li",[t._v("不使用table布局")]),t._v(" "),a("li",[t._v("动画实现的速度的选择")]),t._v(" "),a("li",[t._v("对于动画新建图层")]),t._v(" "),a("li",[t._v("启动GPU硬件加速:transform:translate3d(0,0,0)")])]),t._v(" "),a("h2",{attrs:{id:"浏览器存储"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#浏览器存储","aria-hidden":"true"}},[t._v("#")]),t._v(" 浏览器存储")]),t._v(" "),a("ul",[a("li",[t._v("cookie：浪费请求资源")]),t._v(" "),a("li",[t._v("localStorage：不消失")]),t._v(" "),a("li",[t._v("sessionStorage：页面关闭则消失")]),t._v(" "),a("li",[t._v("service worker：PWA（progressive web app）")])]),t._v(" "),a("h2",{attrs:{id:"缓存：httpheader"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#缓存：httpheader","aria-hidden":"true"}},[t._v("#")]),t._v(" 缓存：httpheader")]),t._v(" "),a("img",{attrs:{src:t.$withBase("/assets/performance-httpheader.png")}}),t._v(" "),a("ol",[a("li",[a("strong",[t._v("cache-control")])])]),t._v(" "),a("ul",[a("li",[a("code",[t._v("max-age")]),t._v("：缓存时间长度，状态为200")]),t._v(" "),a("li",[a("code",[t._v("s-maxage")]),t._v("：优先级高于max-age，只缓存公共资源，例如cdn,状态为304")]),t._v(" "),a("li",[a("code",[t._v("private")]),t._v("：私人缓存，该账号及使用的浏览器")]),t._v(" "),a("li",[a("code",[t._v("public")]),t._v("：共用缓存，与private相反")]),t._v(" "),a("li",[a("code",[t._v("no-cache")]),t._v("：先会去请求服务器，在判断读不读缓存")]),t._v(" "),a("li",[a("code",[t._v("no-store")]),t._v("：不会使用缓存\n"),a("img",{attrs:{src:t.$withBase("/assets/performance-cache1.png")}})])]),t._v(" "),a("ol",{attrs:{start:"2"}},[a("li",[a("strong",[t._v("expires：指定过期日期")])]),t._v(" "),a("li",[a("strong",[t._v("last-modified & if-modified-since")])])]),t._v(" "),a("ul",[a("li",[t._v("状态为304，需要和cache-control共同使用")]),t._v(" "),a("li",[a("code",[t._v("last-modified")]),t._v("：response中出现，表示服务端缓存此文件的时间点")]),t._v(" "),a("li",[a("code",[t._v("if-modified-since")]),t._v("：发送此文件当前收到的last-modified到request，让服务端去判断是否可以使用客户端缓存文件")])]),t._v(" "),a("ol",{attrs:{start:"4"}},[a("li",[a("strong",[t._v("etag & if-none-match")])])]),t._v(" "),a("ul",[a("li",[a("code",[t._v("etag")]),t._v("：response中出现，文件内容hash值")]),t._v(" "),a("li",[a("code",[t._v("if-none-match")]),t._v("：将etag值发送至request，规则与last-modified & if-modified-since相同")])]),t._v(" "),a("img",{attrs:{src:t.$withBase("/assets/performance-cache.png")}}),t._v(" "),a("h2",{attrs:{id:"服务端渲染"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#服务端渲染","aria-hidden":"true"}},[t._v("#")]),t._v(" 服务端渲染")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("过去使用jsp/php")])]),t._v(" "),a("li",[a("p",[t._v("现在使用nuxtjs（Vue）、nextjs（React）实现\n"),a("img",{attrs:{src:t.$withBase("/assets/performance-ssr.png")}})])]),t._v(" "),a("li",[a("p",[a("code",[t._v("Universal Application Code")]),t._v("：套在vue外面，应用在服务端，处理了部分（mounted）钩子")])]),t._v(" "),a("li",[a("p",[t._v("将"),a("code",[t._v("app.js")]),t._v("拆分成"),a("code",[t._v("Server entry")]),t._v("和"),a("code",[t._v("Client entry")])])]),t._v(" "),a("li",[a("p",[t._v("再通过"),a("code",[t._v("webpack")]),t._v("构造"),a("code",[t._v("Server Bundle")]),t._v("和"),a("code",[t._v("Client Bundle")])])]),t._v(" "),a("li",[a("p",[t._v("在Node服务器下"),a("code",[t._v("Server Bundle")]),t._v("通过"),a("code",[t._v("Bundle Renderer")]),t._v("处理成"),a("code",[t._v("HTML")]),t._v("发送给浏览器")])]),t._v(" "),a("li",[a("p",[t._v("在浏览器下通过"),a("code",[t._v("Client Bundle")]),t._v("去解析服务端传来的"),a("code",[t._v("HTML")])])])]),t._v(" "),a("h2",{attrs:{id:"cdn加速"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#cdn加速","aria-hidden":"true"}},[t._v("#")]),t._v(" CDN加速")]),t._v(" "),a("h3",{attrs:{id:"vuecli3中vue-config-js添加cdn配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#vuecli3中vue-config-js添加cdn配置","aria-hidden":"true"}},[t._v("#")]),t._v(" vuecli3中vue.config.js添加CDN配置")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" HtmlWebpackIncludeAssetsPlugin "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'html-webpack-include-assets-plugin'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nmodule"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("chainWebpack")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("config")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    config"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("externals")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        vue"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Vue'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        vuex"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Vuex'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'vue-router'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'VueRouter'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'element-ui'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ELEMENT'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        echarts"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'echarts'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        axios"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'axios'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        lodash"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'_'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    config"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("plugin")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'html-assets'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("use")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("HtmlWebpackIncludeAssetsPlugin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        assets"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/vue/2.6.7/vue.min.js'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/vuex/3.1.0/vuex.min.js'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/vue-router/3.0.2/vue-router.min.js'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/element-ui/2.12.0/index.js'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/element-ui/2.12.0/theme-chalk/index.css'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/axios/0.19.0-beta.1/axios.min.js'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/lodash.js/4.17.11/lodash.min.js'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/echarts/4.2.1/echarts.min.js'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        append"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        publicPath"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'https://cdn.bootcss.com'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])])},[],!1,null,null,null);s.default=e.exports}}]);