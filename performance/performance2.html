<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>优化大纲 | EdpkWu&#39;s Blog</title>
    <meta name="description" content="js =&gt;『解析器』=&gt; AST =&gt;『解释器』=&gt;  字节码 =&gt;『编译器』=&gt; 机器码">
    <link rel="icon" href="/blog/ChristmasLogo.png">
  <link rel="manifest" href="/blog/manifest.json">
    
    <link rel="preload" href="/blog/assets/css/0.styles.ec772434.css" as="style"><link rel="preload" href="/blog/assets/js/app.bf9bb340.js" as="script"><link rel="preload" href="/blog/assets/js/2.a43cf236.js" as="script"><link rel="preload" href="/blog/assets/js/66.37a92162.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.b4c74bab.js"><link rel="prefetch" href="/blog/assets/js/11.d55d5140.js"><link rel="prefetch" href="/blog/assets/js/12.059798c2.js"><link rel="prefetch" href="/blog/assets/js/13.e253bb58.js"><link rel="prefetch" href="/blog/assets/js/14.af853b33.js"><link rel="prefetch" href="/blog/assets/js/15.282e42d3.js"><link rel="prefetch" href="/blog/assets/js/16.bb9a9e4f.js"><link rel="prefetch" href="/blog/assets/js/17.176fc47c.js"><link rel="prefetch" href="/blog/assets/js/18.abf2b6c2.js"><link rel="prefetch" href="/blog/assets/js/19.e3bf546e.js"><link rel="prefetch" href="/blog/assets/js/20.64fe2336.js"><link rel="prefetch" href="/blog/assets/js/21.e38d74ec.js"><link rel="prefetch" href="/blog/assets/js/22.423b001e.js"><link rel="prefetch" href="/blog/assets/js/23.f49f8dd8.js"><link rel="prefetch" href="/blog/assets/js/24.f9af622f.js"><link rel="prefetch" href="/blog/assets/js/25.393531e0.js"><link rel="prefetch" href="/blog/assets/js/26.2ba3ce0b.js"><link rel="prefetch" href="/blog/assets/js/27.1b0e58f3.js"><link rel="prefetch" href="/blog/assets/js/28.ba14b319.js"><link rel="prefetch" href="/blog/assets/js/29.678be965.js"><link rel="prefetch" href="/blog/assets/js/3.cc497458.js"><link rel="prefetch" href="/blog/assets/js/30.2fd9d1be.js"><link rel="prefetch" href="/blog/assets/js/31.a36de58b.js"><link rel="prefetch" href="/blog/assets/js/32.3aa7b9e9.js"><link rel="prefetch" href="/blog/assets/js/33.df85a274.js"><link rel="prefetch" href="/blog/assets/js/34.cda26afe.js"><link rel="prefetch" href="/blog/assets/js/35.a7368511.js"><link rel="prefetch" href="/blog/assets/js/36.588bde1a.js"><link rel="prefetch" href="/blog/assets/js/37.cea26824.js"><link rel="prefetch" href="/blog/assets/js/38.79e376c5.js"><link rel="prefetch" href="/blog/assets/js/39.c6bf4658.js"><link rel="prefetch" href="/blog/assets/js/4.7d932259.js"><link rel="prefetch" href="/blog/assets/js/40.8f6251bf.js"><link rel="prefetch" href="/blog/assets/js/41.de10153c.js"><link rel="prefetch" href="/blog/assets/js/42.b2056ed6.js"><link rel="prefetch" href="/blog/assets/js/43.beecee77.js"><link rel="prefetch" href="/blog/assets/js/44.453a57fc.js"><link rel="prefetch" href="/blog/assets/js/45.1dee6d42.js"><link rel="prefetch" href="/blog/assets/js/46.9000c607.js"><link rel="prefetch" href="/blog/assets/js/47.c18fcd42.js"><link rel="prefetch" href="/blog/assets/js/48.6e67fa4b.js"><link rel="prefetch" href="/blog/assets/js/49.d0452033.js"><link rel="prefetch" href="/blog/assets/js/5.20028d16.js"><link rel="prefetch" href="/blog/assets/js/50.6c420f2d.js"><link rel="prefetch" href="/blog/assets/js/51.95d4bf6e.js"><link rel="prefetch" href="/blog/assets/js/52.4768fd6e.js"><link rel="prefetch" href="/blog/assets/js/53.230ddfc7.js"><link rel="prefetch" href="/blog/assets/js/54.60457e59.js"><link rel="prefetch" href="/blog/assets/js/55.d4b64c74.js"><link rel="prefetch" href="/blog/assets/js/56.80feaf90.js"><link rel="prefetch" href="/blog/assets/js/57.856f0473.js"><link rel="prefetch" href="/blog/assets/js/58.4f4f6b0d.js"><link rel="prefetch" href="/blog/assets/js/59.f69c314d.js"><link rel="prefetch" href="/blog/assets/js/6.9b836da8.js"><link rel="prefetch" href="/blog/assets/js/60.54c06a31.js"><link rel="prefetch" href="/blog/assets/js/61.da4e7ed4.js"><link rel="prefetch" href="/blog/assets/js/62.8ee50f74.js"><link rel="prefetch" href="/blog/assets/js/63.6d42f740.js"><link rel="prefetch" href="/blog/assets/js/64.d560880f.js"><link rel="prefetch" href="/blog/assets/js/65.ece8ecc8.js"><link rel="prefetch" href="/blog/assets/js/67.76268719.js"><link rel="prefetch" href="/blog/assets/js/68.39f1680a.js"><link rel="prefetch" href="/blog/assets/js/69.b6f6ead7.js"><link rel="prefetch" href="/blog/assets/js/7.4abe7d0e.js"><link rel="prefetch" href="/blog/assets/js/70.faa9e817.js"><link rel="prefetch" href="/blog/assets/js/71.15e2e755.js"><link rel="prefetch" href="/blog/assets/js/72.f1529bd0.js"><link rel="prefetch" href="/blog/assets/js/73.24183e41.js"><link rel="prefetch" href="/blog/assets/js/74.d67a981a.js"><link rel="prefetch" href="/blog/assets/js/75.2de3bb24.js"><link rel="prefetch" href="/blog/assets/js/76.2310e05a.js"><link rel="prefetch" href="/blog/assets/js/77.0b826fce.js"><link rel="prefetch" href="/blog/assets/js/78.7a959688.js"><link rel="prefetch" href="/blog/assets/js/79.90fad0c2.js"><link rel="prefetch" href="/blog/assets/js/8.423c1f30.js"><link rel="prefetch" href="/blog/assets/js/80.fbc15757.js"><link rel="prefetch" href="/blog/assets/js/81.5898d3c3.js"><link rel="prefetch" href="/blog/assets/js/82.83a9683a.js"><link rel="prefetch" href="/blog/assets/js/83.42433491.js"><link rel="prefetch" href="/blog/assets/js/84.30be1078.js"><link rel="prefetch" href="/blog/assets/js/85.eed338f0.js"><link rel="prefetch" href="/blog/assets/js/86.83dacfdf.js"><link rel="prefetch" href="/blog/assets/js/87.f7aee5cc.js"><link rel="prefetch" href="/blog/assets/js/9.768e13fd.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.ec772434.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><!----> <span class="site-name">EdpkWu's Blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"> <a href="https://github.com/390405712/blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/390405712/blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>我的插件</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/mytool/distDeploy.html" class="sidebar-link">生产包部署工具</a></li><li><a href="/blog/mytool/frontendLogger.html" class="sidebar-link">前端脚本报错日志采集工具</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>微前端</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/micro-app/qiankun.html" class="sidebar-link">qiankun 框架应用实例</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>代码规范</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/eCodeSpecification/web.html" class="sidebar-link">编码规范(前端版)</a></li><li><a href="/blog/eCodeSpecification/miniApp.html" class="sidebar-link">小程序端</a></li><li><a href="/blog/eCodeSpecification/IDE.html" class="sidebar-link">VScode插件配置</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>框架</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/frame/frame.html" class="sidebar-link">框架对比</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>封装element-ui</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/element-ui/searchGenerator.html" class="sidebar-link">表格搜索生成器</a></li><li><a href="/blog/element-ui/tableGenerator.html" class="sidebar-link">表格生成器</a></li><li><a href="/blog/element-ui/formGenerator.html" class="sidebar-link">表单生成器</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>埋点</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/burialPoint/js.html" class="sidebar-link">js原生埋点</a></li><li><a href="/blog/burialPoint/vue.html" class="sidebar-link">vue埋点</a></li><li><a href="/blog/burialPoint/wx.html" class="sidebar-link">微信原生埋点</a></li><li><a href="/blog/burialPoint/wepy.html" class="sidebar-link">wepy埋点</a></li><li><a href="/blog/burialPoint/documents.html" class="sidebar-link">使用文档</a></li><li><a href="/blog/burialPoint/visual.html" class="sidebar-link">可视化</a></li><li><a href="/blog/burialPoint/vueElementui.html" class="sidebar-link">大数据项目前端为完美适配dom埋点监听编码规范</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>TypeScript</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/TypeScript/" class="sidebar-link">TypeScript</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>&gt;=ES7</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/%3E=es7/" class="sidebar-link">ES6 以后的新特性</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>ES6</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/es6/" class="sidebar-link">总结</a></li><li><a href="/blog/es6/promise.html" class="sidebar-link">Promise</a></li><li><a href="/blog/es6/normal.html" class="sidebar-link">其他常用功能</a></li><li><a href="/blog/es6/array.html" class="sidebar-link">Array</a></li><li><a href="/blog/es6/symbol.html" class="sidebar-link">Symbol</a></li><li><a href="/blog/es6/set&amp;map.html" class="sidebar-link">Set&amp;Map</a></li><li><a href="/blog/es6/proxy.html" class="sidebar-link">Proxy</a></li><li><a href="/blog/es6/reflect.html" class="sidebar-link">Reflect</a></li><li><a href="/blog/es6/Iterator.html" class="sidebar-link">Iterator</a></li><li><a href="/blog/es6/generator.html" class="sidebar-link">Generator</a></li><li><a href="/blog/es6/async.html" class="sidebar-link">async</a></li><li><a href="/blog/es6/class.html" class="sidebar-link">Class</a></li><li><a href="/blog/es6/module.html" class="sidebar-link">模块化</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>style</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/style/flex.html" class="sidebar-link">flex布局</a></li><li><a href="/blog/style/scss.html" class="sidebar-link">SCSS使用方法</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>性能优化</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/performance/performance1.html" class="sidebar-link">性能优化</a></li><li><a href="/blog/performance/performance2.html" class="active sidebar-link">优化大纲</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/performance/performance2.html#优化指标-rail" class="sidebar-link">优化指标 RAIL</a></li><li class="sidebar-sub-header"><a href="/blog/performance/performance2.html#js-性能测量-api" class="sidebar-link">js 性能测量 api</a></li><li class="sidebar-sub-header"><a href="/blog/performance/performance2.html#监听页面不在窗口显示" class="sidebar-link">监听页面不在窗口显示</a></li><li class="sidebar-sub-header"><a href="/blog/performance/performance2.html#浏览器渲染流程" class="sidebar-link">浏览器渲染流程</a></li><li class="sidebar-sub-header"><a href="/blog/performance/performance2.html#影响回流的操作" class="sidebar-link">影响回流的操作</a></li><li class="sidebar-sub-header"><a href="/blog/performance/performance2.html#避免布局抖动-layou-thrashing" class="sidebar-link">避免布局抖动 layou thrashing</a></li><li class="sidebar-sub-header"><a href="/blog/performance/performance2.html#复合线程-componsitor-thread-与图层-layers" class="sidebar-link">复合线程 componsitor thread 与图层 layers</a></li><li class="sidebar-sub-header"><a href="/blog/performance/performance2.html#减少重绘-repaint" class="sidebar-link">减少重绘 repaint</a></li><li class="sidebar-sub-header"><a href="/blog/performance/performance2.html#时间调度实现" class="sidebar-link">时间调度实现</a></li><li class="sidebar-sub-header"><a href="/blog/performance/performance2.html#js-文件优化" class="sidebar-link">js 文件优化</a></li><li class="sidebar-sub-header"><a href="/blog/performance/performance2.html#减少主线程工作量" class="sidebar-link">减少主线程工作量</a></li><li class="sidebar-sub-header"><a href="/blog/performance/performance2.html#适应-v8-的优化" class="sidebar-link">适应 v8 的优化</a></li><li class="sidebar-sub-header"><a href="/blog/performance/performance2.html#html-优化" class="sidebar-link">HTML 优化</a></li><li class="sidebar-sub-header"><a href="/blog/performance/performance2.html#css-优化" class="sidebar-link">CSS 优化</a></li><li class="sidebar-sub-header"><a href="/blog/performance/performance2.html#图片优化" class="sidebar-link">图片优化</a></li><li class="sidebar-sub-header"><a href="/blog/performance/performance2.html#webpack" class="sidebar-link">WebPack!!!</a></li><li class="sidebar-sub-header"><a href="/blog/performance/performance2.html#分析生产包" class="sidebar-link">分析生产包</a></li><li class="sidebar-sub-header"><a href="/blog/performance/performance2.html#动态加载-js" class="sidebar-link">动态加载 js</a></li><li class="sidebar-sub-header"><a href="/blog/performance/performance2.html#nginx-资源优化" class="sidebar-link">nginx 资源优化</a></li><li class="sidebar-sub-header"><a href="/blog/performance/performance2.html#ssr" class="sidebar-link">SSR</a></li><li class="sidebar-sub-header"><a href="/blog/performance/performance2.html#html-标签属性" class="sidebar-link">html 标签属性</a></li><li class="sidebar-sub-header"><a href="/blog/performance/performance2.html#提高滚动列表性能插件" class="sidebar-link">提高滚动列表性能插件</a></li><li class="sidebar-sub-header"><a href="/blog/performance/performance2.html#骨架屏" class="sidebar-link">骨架屏</a></li></ul></li><li><a href="/blog/performance/performance3.html" class="sidebar-link">从输入 url 到页面加载显示完成都发生了什么？</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>开发环境</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/IDE/git.html" class="sidebar-link">Git</a></li><li><a href="/blog/IDE/linux.html" class="sidebar-link">Linux命令</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Vue实际使用</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/vueAdvanced/interpolation.html" class="sidebar-link">插值</a></li><li><a href="/blog/vueAdvanced/api.html" class="sidebar-link">全局api</a></li><li><a href="/blog/vueAdvanced/template.html" class="sidebar-link">模板</a></li><li><a href="/blog/vueAdvanced/vue3.0.html" class="sidebar-link">Vue3.0</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>MVVM和vue</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/vue/" class="sidebar-link">总结</a></li><li><a href="/blog/vue/mvc.html" class="sidebar-link">MVC框架</a></li><li><a href="/blog/vue/mvvm.html" class="sidebar-link">MVVM框架</a></li><li><a href="/blog/vue/defineProperty.html" class="sidebar-link">响应式defineProperty</a></li><li><a href="/blog/vue/template.html" class="sidebar-link">模板解析</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>虚拟DOM</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/vdom/" class="sidebar-link">总结</a></li><li><a href="/blog/vdom/vdom-jquery.html" class="sidebar-link">jquery渲染原理</a></li><li><a href="/blog/vdom/vdom-snabbdom.html" class="sidebar-link">vdom的起源：snabbdom</a></li><li><a href="/blog/vdom/diff-algorithm.html" class="sidebar-link">diff算法</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>异步</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/async/" class="sidebar-link">总结</a></li><li><a href="/blog/async/single-thread.html" class="sidebar-link">单线程</a></li><li><a href="/blog/async/event-loop.html" class="sidebar-link">event-loop（事件轮询）</a></li><li><a href="/blog/async/jquery-deferred.html" class="sidebar-link">jquery-deferred（延迟）</a></li><li><a href="/blog/async/promise.html" class="sidebar-link">promise</a></li><li><a href="/blog/async/async-await.html" class="sidebar-link">Async-Await</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>原型</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/prototype/" class="sidebar-link">总结</a></li><li><a href="/blog/prototype/prototype.html" class="sidebar-link">原型链</a></li><li><a href="/blog/prototype/jQuery.html" class="sidebar-link">jQuery</a></li><li><a href="/blog/prototype/Zepto.html" class="sidebar-link">Zepto</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>js-Web-Api</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/js-Web-Api/DomBom.html" class="sidebar-link">Dom &amp; Bom</a></li><li><a href="/blog/js-Web-Api/event.html" class="sidebar-link">事件</a></li><li><a href="/blog/js-Web-Api/storage.html" class="sidebar-link">存储</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>js基础</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/base/variable.html" class="sidebar-link">js基础</a></li><li><a href="/blog/base/prototype.html" class="sidebar-link">原型、原型链、构造函数</a></li><li><a href="/blog/base/scope.html" class="sidebar-link">作用域和闭包</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="优化大纲"><a href="#优化大纲" aria-hidden="true" class="header-anchor">#</a> 优化大纲</h1> <h2 id="优化指标-rail"><a href="#优化指标-rail" aria-hidden="true" class="header-anchor">#</a> 优化指标 RAIL</h2> <ul><li>Response 响应（处理事件应在 50ms 以内完成）</li> <li>Animation 动画（每 10ms 产生一帧）</li> <li>Idle 空闲（尽可能增加空闲时间）</li> <li>Load 加载（在 5s 内完成内容并可以交互）</li></ul> <h2 id="js-性能测量-api"><a href="#js-性能测量-api" aria-hidden="true" class="header-anchor">#</a> js 性能测量 api</h2> <ul><li>DNS 解析耗时: domainLookupEnd - domainLookupStart</li> <li>TCP 连接耗时: connectEnd - connectStart</li> <li>SSL 安全连接耗时: connectEnd - secureConnectionStart</li> <li>网络请求耗时 (TTFB): responseStart - requestStart</li> <li>数据传输耗时: responseEnd - responseStart</li> <li>DOM 解析耗时: domInteractive - responseEnd</li> <li>资源加载耗时: loadEventStart - domContentLoadedEventEnd</li> <li>First Byte 时间: responseStart - domainLookupStart</li> <li>白屏时间: responseEnd - fetchStart</li> <li>首次可交互时间: domInteractive - fetchStart</li> <li>DOM Ready 时间: domContentLoadEventEnd - fetchStart</li> <li>页面完全加载时间: loadEventStart - fetchStart</li> <li>http 头部大小： transferSize - encodedBodySize</li> <li>重定向次数：performance.navigation.redirectCount</li> <li>重定向耗时: redirectEnd - redirectStart</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> timing <span class="token operator">=</span> performance<span class="token punctuation">.</span><span class="token function">getEntriesByType</span><span class="token punctuation">(</span><span class="token string">'navigation'</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> tti <span class="token operator">=</span> timing<span class="token punctuation">.</span>domInteractive <span class="token operator">-</span> timing<span class="token punctuation">.</span>fetchStart
</code></pre></div><h2 id="监听页面不在窗口显示"><a href="#监听页面不在窗口显示" aria-hidden="true" class="header-anchor">#</a> 监听页面不在窗口显示</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> vEvent <span class="token operator">=</span> <span class="token string">'visibilitychange'</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>document<span class="token punctuation">.</span>webkitHidden<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  vEvent <span class="token operator">=</span> <span class="token string">'webkitvisibilitychange'</span>
<span class="token punctuation">}</span>
document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span>
  vEvent<span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>document<span class="token punctuation">.</span>hidden <span class="token operator">||</span> document<span class="token punctuation">.</span>webkitHidden<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'离开了'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'还在'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token boolean">false</span>
<span class="token punctuation">)</span>
</code></pre></div><h2 id="浏览器渲染流程"><a href="#浏览器渲染流程" aria-hidden="true" class="header-anchor">#</a> 浏览器渲染流程</h2> <p>js =&gt; style =&gt; layout =&gt; paint =&gt; composite</p> <h2 id="影响回流的操作"><a href="#影响回流的操作" aria-hidden="true" class="header-anchor">#</a> 影响回流的操作</h2> <ul><li>添加、删除元素</li> <li>操作 styles</li> <li>display:none</li> <li>offsetLeft、scrollTop、clientWidth</li> <li>移动元素位置</li> <li>修改浏览器大小、文字大小</li></ul> <h2 id="避免布局抖动-layou-thrashing"><a href="#避免布局抖动-layou-thrashing" aria-hidden="true" class="header-anchor">#</a> 避免布局抖动 layou thrashing</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 一般 每秒处理60帧的调用 1000/60=16.67ms  rAF =&gt; Layout =&gt; Paint</span>
<span class="token keyword">let</span> ticking <span class="token operator">=</span> <span class="token boolean">false</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>ticking<span class="token punctuation">)</span> <span class="token keyword">return</span>
ticking <span class="token operator">=</span> <span class="token boolean">true</span>
window<span class="token punctuation">.</span><span class="token function">requestAnimationFrame</span><span class="token punctuation">(</span>fn<span class="token punctuation">)</span>
ticking <span class="token operator">=</span> <span class="token boolean">false</span>

<span class="token comment">// 优 插件：fastdom</span>
fastdom<span class="token punctuation">.</span><span class="token function">measure</span><span class="token punctuation">(</span>fn<span class="token punctuation">)</span>
fastdom<span class="token punctuation">.</span><span class="token function">mutate</span><span class="token punctuation">(</span>fn<span class="token punctuation">)</span>
fastdom<span class="token punctuation">.</span><span class="token function">measure</span><span class="token punctuation">(</span>fn<span class="token punctuation">)</span>
fastdom<span class="token punctuation">.</span><span class="token function">mutate</span><span class="token punctuation">(</span>fn<span class="token punctuation">)</span>
<span class="token comment">// measure</span>
<span class="token comment">// measure</span>
<span class="token comment">// mutate</span>
<span class="token comment">// mutate</span>
</code></pre></div><h2 id="复合线程-componsitor-thread-与图层-layers"><a href="#复合线程-componsitor-thread-与图层-layers" aria-hidden="true" class="header-anchor">#</a> 复合线程 componsitor thread 与图层 layers</h2> <ul><li>将页面拆分图层进行绘制再进行复合</li> <li>利用 DevTools 了解图层拆分情况</li> <li>哪些样式仅影响复合</li></ul> <h2 id="减少重绘-repaint"><a href="#减少重绘-repaint" aria-hidden="true" class="header-anchor">#</a> 减少重绘 repaint</h2> <ul><li>使用 transform</li> <li>单独提取到新的图层 will-change:'transform'</li></ul> <h2 id="时间调度实现"><a href="#时间调度实现" aria-hidden="true" class="header-anchor">#</a> 时间调度实现</h2> <ul><li>rAF =&gt; Layout =&gt; Paint =&gt; requestIdleCallback(rLC)</li> <li>rLC 兼容性差</li> <li>rAF 可以模拟 rLC 的效果</li></ul> <h2 id="js-文件优化"><a href="#js-文件优化" aria-hidden="true" class="header-anchor">#</a> js 文件优化</h2> <ul><li>按需加载 export &amp; import</li> <li>Tree shaking</li></ul> <h2 id="减少主线程工作量"><a href="#减少主线程工作量" aria-hidden="true" class="header-anchor">#</a> 减少主线程工作量</h2> <ul><li>避免长任务</li> <li>避免超过 1kb 行间脚本</li> <li>使用 rAF、rIC 进行时间调度</li> <li>初次只提取首屏需要的资源，提高首屏速度</li></ul> <h2 id="适应-v8-的优化"><a href="#适应-v8-的优化" aria-hidden="true" class="header-anchor">#</a> 适应 v8 的优化</h2> <p>node --trace-opt --trace-deopt de-opt.js</p> <ul><li>对象优化</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">/* 1 */</span>
<span class="token keyword">class</span> <span class="token class-name">RectArea</span> <span class="token punctuation">{</span>
  <span class="token comment">// HC0</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">l<span class="token punctuation">,</span> w</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>l <span class="token operator">=</span> l <span class="token comment">// HC1</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>w <span class="token operator">=</span> w <span class="token comment">// HC2</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> rect1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RectArea</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token comment">// 创建了隐藏类HC0, HC1, HC2</span>
<span class="token keyword">const</span> rect2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RectArea</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span> <span class="token comment">// 相同的对象结构，可复用之前的所有隐藏类</span>

<span class="token keyword">const</span> car1 <span class="token operator">=</span> <span class="token punctuation">{</span> color<span class="token punctuation">:</span> <span class="token string">'red'</span> <span class="token punctuation">}</span> <span class="token comment">// HC0</span>
car1<span class="token punctuation">.</span>seats <span class="token operator">=</span> <span class="token number">4</span> <span class="token comment">// HC1</span>

<span class="token keyword">const</span> car2 <span class="token operator">=</span> <span class="token punctuation">{</span> seats<span class="token punctuation">:</span> <span class="token number">2</span> <span class="token punctuation">}</span> <span class="token comment">// 没有可复用的隐藏类，创建HC2</span>
car2<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token string">'blue'</span> <span class="token comment">// 没有可复用的隐藏类，创建HC3</span>

<span class="token comment">/* 2 */</span>
<span class="token keyword">const</span> car1 <span class="token operator">=</span> <span class="token punctuation">{</span> color<span class="token punctuation">:</span> <span class="token string">'red'</span> <span class="token punctuation">}</span> <span class="token comment">// In-object 属性</span>
car1<span class="token punctuation">.</span>seats <span class="token operator">=</span> <span class="token number">4</span> <span class="token comment">// Normal/Fast 属性，存储在property store里，需要通过描述数组间接查找</span>

<span class="token comment">/* 3 */</span>
<span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>arrObj<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">value<span class="token punctuation">,</span> index</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 不如在真实数组上效率高</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>index<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>value<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> arr <span class="token operator">=</span> <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>arrObj<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment">// 转换的代价比影响优化小</span>
arr<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">value<span class="token punctuation">,</span> index</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>index<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>value<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">/* 4 */</span>
<span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token parameter">array</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> array<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 越界比较</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>array<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">1000</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 1.沿原型链的查找 2.造成undefined与数进行比较</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>array<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">// 业务上无效、出错</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">/* 5 */</span>
<span class="token keyword">const</span> array <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token comment">// PACKED_SMI_ELEMENTS</span>
array<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token number">4.4</span><span class="token punctuation">)</span> <span class="token comment">// PACKED_DOUBLE_ELEMENTS</span>
</code></pre></div><ul><li>函数优化</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token function-variable function">add</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> a <span class="token operator">*</span> b <span class="token comment">// lazy parsing</span>
  <span class="token comment">// const add = ((a, b) =&gt; a*b); // eager parsing</span>
  <span class="token keyword">const</span> num1 <span class="token operator">=</span> <span class="token number">1</span>
  <span class="token keyword">const</span> num2 <span class="token operator">=</span> <span class="token number">2</span>
  <span class="token function">add</span><span class="token punctuation">(</span>num1<span class="token punctuation">,</span> num2<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>反优化</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> performance<span class="token punctuation">,</span> PerformanceObserver <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'perf_hooks'</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> <span class="token function-variable function">add</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> a <span class="token operator">+</span> b

<span class="token keyword">const</span> num1 <span class="token operator">=</span> <span class="token number">1</span>
<span class="token keyword">const</span> num2 <span class="token operator">=</span> <span class="token number">2</span>

performance<span class="token punctuation">.</span><span class="token function">mark</span><span class="token punctuation">(</span><span class="token string">'start'</span><span class="token punctuation">)</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10000000</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">add</span><span class="token punctuation">(</span>num1<span class="token punctuation">,</span> num2<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token function">add</span><span class="token punctuation">(</span>num1<span class="token punctuation">,</span> <span class="token string">'s'</span><span class="token punctuation">)</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10000000</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">add</span><span class="token punctuation">(</span>num1<span class="token punctuation">,</span> num2<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

performance<span class="token punctuation">.</span><span class="token function">mark</span><span class="token punctuation">(</span><span class="token string">'end'</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> observer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PerformanceObserver</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">list</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>list<span class="token punctuation">.</span><span class="token function">getEntries</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
observer<span class="token punctuation">.</span><span class="token function">observe</span><span class="token punctuation">(</span><span class="token punctuation">{</span> entryTypes<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'measure'</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>

performance<span class="token punctuation">.</span><span class="token function">measure</span><span class="token punctuation">(</span><span class="token string">'测量1'</span><span class="token punctuation">,</span> <span class="token string">'start'</span><span class="token punctuation">,</span> <span class="token string">'end'</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="html-优化"><a href="#html-优化" aria-hidden="true" class="header-anchor">#</a> HTML 优化</h2> <ul><li>减小 iframes 的使用</li> <li>压缩</li> <li>避免深层嵌套</li> <li>不使用 table 布局</li> <li>删除注释</li> <li>css、js 外链</li> <li>删除元素默认属性</li></ul> <h2 id="css-优化"><a href="#css-优化" aria-hidden="true" class="header-anchor">#</a> CSS 优化</h2> <ul><li>压缩</li> <li>尽早解析 css</li> <li>利用 GPU 进行动画，减少回流、重绘</li> <li>font-display: auto | block | swap | fallback | optional</li> <li>contain: none | strict | layout | style | paint | size | contain
-- layout: 向浏览器说明元素内和元素外的布局互不侵犯。相当于做了三件事情
1.display: flow-root，创建 BFC(Block Formatting Context)
2.position: relative，创建了 containing block 3.可以使用 z-index 属性，相当于创建了 stacking context
-- paint: 内部元素超过包含元素的部分不可见
-- size: 元素的大小不会改变，如果元素没有指定高度而是靠内部的元素扩展的话，那么这个元素的高度为 0
-- content: layout+paint
-- strict: layout+paint+strict</li></ul> <h2 id="图片优化"><a href="#图片优化" aria-hidden="true" class="header-anchor">#</a> 图片优化</h2> <ul><li>压缩</li> <li>渐进式图片 体验高于 基线式图片</li> <li>响应式图片 用于不同分辨率的情况</li></ul> <h2 id="webpack"><a href="#webpack" aria-hidden="true" class="header-anchor">#</a> WebPack!!!</h2> <ul><li>资源压缩 minification</li> <li>js 压缩 uglifyjs-webpack-plugin</li> <li>支持 es6 的压缩 terser-webpack-plugin</li> <li>按需引入 polyfill</li> <li>辅助函数按需引入</li> <li>适配一定范围的浏览器</li> <li>抽取底层库，不进行解析</li> <li>异步加载、懒加载 js</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// webpack.config.js</span>
<span class="token keyword">const</span> webpack <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> HtmlWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'html-webpack-plugin'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> CopyPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'copy-webpack-plugin'</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> MiniCssExtractPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'mini-css-extract-plugin'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> OptimizeCssAssetsPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'optimize-css-assets-webpack-plugin'</span><span class="token punctuation">)</span>

<span class="token comment">// const DllReferencePlugin = require('webpack/lib/DllReferencePlugin');</span>

<span class="token keyword">const</span> SpeedMeasurePlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'speed-measure-webpack-plugin'</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> smp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SpeedMeasurePlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> isProduction <span class="token operator">=</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">===</span> <span class="token string">'production'</span>

<span class="token keyword">const</span> WorkboxWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'workbox-webpack-plugin'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> ManifestPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack-manifest-plugin'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> paths <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./paths'</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> smp<span class="token punctuation">.</span><span class="token function">wrap</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  mode<span class="token punctuation">:</span> <span class="token string">'production'</span><span class="token punctuation">,</span>
  devtool<span class="token punctuation">:</span> <span class="token string">'source-map'</span><span class="token punctuation">,</span>
  devServer<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    port<span class="token punctuation">:</span> <span class="token number">3000</span><span class="token punctuation">,</span>
    historyApiFallback<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  context<span class="token punctuation">:</span> __dirname<span class="token punctuation">,</span>
  entry<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    app<span class="token punctuation">:</span> <span class="token string">'./src/index.jsx'</span><span class="token punctuation">,</span>
    <span class="token comment">// test: './src/test.js' // 测试函数lazy parsing, eager parsing</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  output<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    path<span class="token punctuation">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>__dirname<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/build</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    filename<span class="token punctuation">:</span> <span class="token string">'[name].[hash].bundle.js'</span><span class="token punctuation">,</span>
    chunkFilename<span class="token punctuation">:</span> <span class="token string">'[name].[chunkhash:8].bundle.js'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  optimization<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    splitChunks<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      cacheGroups<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        vendor<span class="token punctuation">:</span> <span class="token punctuation">{</span>
          name<span class="token punctuation">:</span> <span class="token string">'vendor'</span><span class="token punctuation">,</span>
          test<span class="token punctuation">:</span> <span class="token regex">/[\\/]node_modules[\\/]/</span><span class="token punctuation">,</span>
          minSize<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
          minChunks<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token comment">// 最小代码段</span>
          priority<span class="token punctuation">:</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token comment">// 优先级任务</span>
          chunks<span class="token punctuation">:</span> <span class="token string">'initial'</span><span class="token punctuation">,</span> <span class="token comment">// 同步加载</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        common<span class="token punctuation">:</span> <span class="token punctuation">{</span>
          name<span class="token punctuation">:</span> <span class="token string">'common'</span><span class="token punctuation">,</span>
          test<span class="token punctuation">:</span> <span class="token regex">/[\\/]src[\\/]/</span><span class="token punctuation">,</span>
          chunks<span class="token punctuation">:</span> <span class="token string">'all'</span><span class="token punctuation">,</span> <span class="token comment">// 同步、异步</span>
          minSize<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
          minChunks<span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  resolve<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    extensions<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'.js'</span><span class="token punctuation">,</span> <span class="token string">'.jsx'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  module<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    noParse<span class="token punctuation">:</span> <span class="token regex">/lodash/</span><span class="token punctuation">,</span>
    rules<span class="token punctuation">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        test<span class="token punctuation">:</span> <span class="token regex">/\.jsx?$/</span><span class="token punctuation">,</span>
        loader<span class="token punctuation">:</span> <span class="token string">'babel-loader'</span><span class="token punctuation">,</span>
        include<span class="token punctuation">:</span> <span class="token regex">/src/</span><span class="token punctuation">,</span>
        exclude<span class="token punctuation">:</span> <span class="token regex">/node_modules/</span><span class="token punctuation">,</span>
        query<span class="token punctuation">:</span> <span class="token punctuation">{</span>
          presets<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'@babel/preset-react'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        test<span class="token punctuation">:</span> <span class="token regex">/(\.css$)/</span><span class="token punctuation">,</span>
        use<span class="token punctuation">:</span> <span class="token punctuation">[</span>
          isProduction
            <span class="token operator">?</span> <span class="token punctuation">{</span>
                loader<span class="token punctuation">:</span> MiniCssExtractPlugin<span class="token punctuation">.</span>loader<span class="token punctuation">,</span>
              <span class="token punctuation">}</span>
            <span class="token punctuation">:</span> <span class="token punctuation">{</span>
                loader<span class="token punctuation">:</span> <span class="token string">'style-loader'</span><span class="token punctuation">,</span>
              <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">{</span>
            loader<span class="token punctuation">:</span> <span class="token string">'css-loader'</span><span class="token punctuation">,</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">{</span>
            loader<span class="token punctuation">:</span> <span class="token string">'postcss-loader'</span><span class="token punctuation">,</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        test<span class="token punctuation">:</span> <span class="token regex">/\.(png|woff|woff2|eot|ttf)$/</span><span class="token punctuation">,</span>
        loader<span class="token punctuation">:</span> <span class="token string">'url-loader?limit=100000'</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        test<span class="token punctuation">:</span> <span class="token regex">/\.(png|jp(e*)g|gif)$/</span><span class="token punctuation">,</span>
        use<span class="token punctuation">:</span> <span class="token punctuation">[</span>
          <span class="token punctuation">{</span>
            loader<span class="token punctuation">:</span> <span class="token string">'file-loader'</span><span class="token punctuation">,</span>
            options<span class="token punctuation">:</span> <span class="token punctuation">{</span>
              name<span class="token punctuation">:</span> <span class="token string">'images/[hash]-[name].[ext]'</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        test<span class="token punctuation">:</span> <span class="token regex">/\.svg$/</span><span class="token punctuation">,</span>
        use<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'@svgr/webpack'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>DefinePlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token string">'process.env.PUBLIC_URL'</span><span class="token punctuation">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      template<span class="token punctuation">:</span> <span class="token string">'template.html'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token class-name">CopyPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      patterns<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> <span class="token keyword">from</span><span class="token punctuation">:</span> <span class="token string">'./img/*'</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token class-name">MiniCssExtractPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      filename<span class="token punctuation">:</span> <span class="token string">'[name].[contenthash].css'</span><span class="token punctuation">,</span>
      chunkFilename<span class="token punctuation">:</span> <span class="token string">'[id].[contenthash:8].css'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token class-name">OptimizeCssAssetsPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      cssProcessorPluginOptions<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        preset<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'default'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> discardComments<span class="token punctuation">:</span> <span class="token punctuation">{</span> removeAll<span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      canPrint<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token comment">/* 动态链接库引用 */</span>
    <span class="token comment">/*new DllReferencePlugin({
            manifest: require(`${__dirname}/dll/react.manifest.json`)
        })*/</span>

    <span class="token keyword">new</span> <span class="token class-name">WorkboxWebpackPlugin<span class="token punctuation">.</span>GenerateSW</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      clientsClaim<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      exclude<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token regex">/\.map$/</span><span class="token punctuation">,</span> <span class="token regex">/asset-manifest\.json$/</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      importWorkboxFrom<span class="token punctuation">:</span> <span class="token string">'cdn'</span><span class="token punctuation">,</span>
      navigateFallback<span class="token punctuation">:</span> paths<span class="token punctuation">.</span>publicUrlOrPath <span class="token operator">+</span> <span class="token string">'index.html'</span><span class="token punctuation">,</span>
      navigateFallbackBlacklist<span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token comment">// Exclude URLs starting with /_, as they're likely an API call</span>
        <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token string">'^/_'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token comment">// Exclude any URLs whose last part seems to be a file extension</span>
        <span class="token comment">// as they're likely a resource and not a SPA route.</span>
        <span class="token comment">// URLs containing a &quot;?&quot; character won't be blacklisted as they're likely</span>
        <span class="token comment">// a route with query params (e.g. auth callbacks).</span>
        <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token string">'/[^/?]+\\.[^/]+$'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

    <span class="token keyword">new</span> <span class="token class-name">ManifestPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      fileName<span class="token punctuation">:</span> <span class="token string">'asset-manifest.json'</span><span class="token punctuation">,</span>
      publicPath<span class="token punctuation">:</span> paths<span class="token punctuation">.</span>publicUrlOrPath<span class="token punctuation">,</span>
      <span class="token function-variable function">generate</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token parameter">seed<span class="token punctuation">,</span> files<span class="token punctuation">,</span> entrypoints</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> manifestFiles <span class="token operator">=</span> files<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">manifest<span class="token punctuation">,</span> file</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          manifest<span class="token punctuation">[</span>file<span class="token punctuation">.</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> file<span class="token punctuation">.</span>path
          <span class="token keyword">return</span> manifest
        <span class="token punctuation">}</span><span class="token punctuation">,</span> seed<span class="token punctuation">)</span>
        <span class="token keyword">const</span> entrypointFiles <span class="token operator">=</span> entrypoints<span class="token punctuation">.</span>app<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>
          <span class="token punctuation">(</span><span class="token parameter">fileName</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token operator">!</span>fileName<span class="token punctuation">.</span><span class="token function">endsWith</span><span class="token punctuation">(</span><span class="token string">'.map'</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span>

        <span class="token keyword">return</span> <span class="token punctuation">{</span>
          files<span class="token punctuation">:</span> manifestFiles<span class="token punctuation">,</span>
          entrypoints<span class="token punctuation">:</span> entrypointFiles<span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// webpack.dll.config.js</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> webpack <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack'</span><span class="token punctuation">)</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  mode<span class="token punctuation">:</span> <span class="token string">'production'</span><span class="token punctuation">,</span>
  entry<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    react<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'react'</span><span class="token punctuation">,</span> <span class="token string">'react-dom'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  output<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    filename<span class="token punctuation">:</span> <span class="token string">'[name].dll.js'</span><span class="token punctuation">,</span>
    path<span class="token punctuation">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'dll'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    library<span class="token punctuation">:</span> <span class="token string">'[name]'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>DllPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      name<span class="token punctuation">:</span> <span class="token string">'[name]'</span><span class="token punctuation">,</span>
      path<span class="token punctuation">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'dll/[name].manifest.json'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// babel.config.js</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  presets<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">[</span>
      <span class="token string">'@babel/preset-env'</span><span class="token punctuation">,</span> <span class="token comment">// polyfill</span>
      <span class="token punctuation">{</span>
        modules<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        targets<span class="token punctuation">:</span> <span class="token punctuation">{</span>
          browsers<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'&gt;0.25%'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        useBuiltIns<span class="token punctuation">:</span> <span class="token string">'usage'</span><span class="token punctuation">,</span>
        bugfixes<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'@babel/preset-react'</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token string">'@babel/plugin-proposal-class-properties'</span><span class="token punctuation">,</span> <span class="token comment">// class复用</span>
    <span class="token string">'@babel/plugin-transform-runtime'</span><span class="token punctuation">,</span> <span class="token comment">// 方法复用</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="分析生产包"><a href="#分析生产包" aria-hidden="true" class="header-anchor">#</a> 分析生产包</h2> <ul><li>生产包体积分析 webpack-bundle-analyzer</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function-variable function">chainWebpack</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token parameter">config</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  config
    <span class="token punctuation">.</span><span class="token function">plugin</span><span class="token punctuation">(</span><span class="token string">'webpack-report'</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack-bundle-analyzer'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>BundleAnalyzerPlugin<span class="token punctuation">,</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span> analyzerMode<span class="token punctuation">:</span> <span class="token string">'static'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>webpack 执行速度分析 speed-measure-webpack-plugin</li></ul> <h2 id="动态加载-js"><a href="#动态加载-js" aria-hidden="true" class="header-anchor">#</a> 动态加载 js</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>window<span class="token punctuation">.</span><span class="token constant">XLSX</span> <span class="token operator">&amp;&amp;</span> window<span class="token punctuation">.</span><span class="token constant">XLSXSTYLE</span><span class="token punctuation">)</span>
    <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token constant">XLSX</span><span class="token punctuation">:</span> window<span class="token punctuation">.</span><span class="token constant">XLSX</span><span class="token punctuation">,</span> <span class="token constant">XLSXSTYLE</span><span class="token punctuation">:</span> window<span class="token punctuation">.</span><span class="token constant">XLSXSTYLE</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token string">'/wlh-xlsx-style/1.0.0/dist/jszip.js'</span><span class="token punctuation">,</span>
    <span class="token string">'/wlh-xlsx-style/1.0.0/xlsx.js'</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span>
  <span class="token keyword">const</span> frag <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createDocumentFragment</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  arr<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> script <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'script'</span><span class="token punctuation">)</span>
    script<span class="token punctuation">.</span>type <span class="token operator">=</span> <span class="token string">'text/javascript'</span>
    script<span class="token punctuation">.</span>async <span class="token operator">=</span> <span class="token boolean">true</span>
    script<span class="token punctuation">.</span>src <span class="token operator">=</span> item
    frag<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>script<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>frag<span class="token punctuation">)</span>
  <span class="token keyword">const</span> timer <span class="token operator">=</span> <span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>window<span class="token punctuation">.</span><span class="token constant">XLSX</span> <span class="token operator">&amp;&amp;</span> window<span class="token punctuation">.</span><span class="token constant">XLSXSTYLE</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token constant">XLSX</span><span class="token punctuation">:</span> window<span class="token punctuation">.</span><span class="token constant">XLSX</span><span class="token punctuation">,</span> <span class="token constant">XLSXSTYLE</span><span class="token punctuation">:</span> window<span class="token punctuation">.</span><span class="token constant">XLSXSTYLE</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token function">clearInterval</span><span class="token punctuation">(</span>timer<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="nginx-资源优化"><a href="#nginx-资源优化" aria-hidden="true" class="header-anchor">#</a> nginx 资源优化</h2> <ul><li>gzip</li> <li>gzip-static</li> <li>资源持久化 index.html hash</li> <li>资源缓存配置</li></ul> <h2 id="ssr"><a href="#ssr" aria-hidden="true" class="header-anchor">#</a> SSR</h2> <ul><li>Nuxt.js</li></ul> <h2 id="html-标签属性"><a href="#html-标签属性" aria-hidden="true" class="header-anchor">#</a> html 标签属性</h2> <ul><li>async 异步</li> <li>defer 按顺序</li> <li>prefetch 预渲染</li> <li><code>import(/* webpackPrefetch: true */ 'login')</code></li></ul> <h2 id="提高滚动列表性能插件"><a href="#提高滚动列表性能插件" aria-hidden="true" class="header-anchor">#</a> 提高滚动列表性能插件</h2> <ul><li>react-window</li></ul> <h2 id="骨架屏"><a href="#骨架屏" aria-hidden="true" class="header-anchor">#</a> 骨架屏</h2> <ul><li>减少回流</li></ul></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/blog/performance/performance1.html" class="prev">
          性能优化
        </a></span> <span class="next"><a href="/blog/performance/performance3.html">
          从输入 url 到页面加载显示完成都发生了什么？
        </a>
        →
      </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/blog/assets/js/app.bf9bb340.js" defer></script><script src="/blog/assets/js/2.a43cf236.js" defer></script><script src="/blog/assets/js/66.37a92162.js" defer></script>
  </body>
</html>
